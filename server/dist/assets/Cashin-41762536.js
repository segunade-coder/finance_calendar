import{r as a,M as Q,j as e}from"./index-82ae9a98.js";import{B as i}from"./index.esm-6519f0fc.js";import{D as c}from"./dialog.esm-c994e1f7.js";import{D as X,C as d,I as Z,a as ee}from"./column.esm-8dcd74ef.js";import{D as se}from"./index.esm-3999b91b.js";import{C as ae}from"./cashin-d9824aaa.js";const ce=()=>{var H,M,B;const{io:o}=a.useContext(Q),[h,l]=a.useState(!1),[p,S]=a.useState(""),[u,b]=a.useState(""),[m,v]=a.useState(""),[D,F]=a.useState([]),[w,I]=a.useState([]),[x,U]=a.useState(0),[j,O]=a.useState(0),[g,z]=a.useState(0),[f,V]=a.useState(0),[N,_]=a.useState([]),[T,k]=a.useState(!1),[E,L]=a.useState(!1),[A,R]=a.useState(!1),[W,$]=a.useState([]);a.useEffect(()=>{o.emit("get-cashin"),o.emit("get-summary"),o.on("set-summary",({cashin:s,cashout:t,totalDebt:C,totalRevenue:n,other:K,others2:P})=>{F(s),I(t),U(s.map(r=>r.cashin).reduce((r,y)=>r+y,0)-t.map(r=>r.cashout).reduce((r,y)=>r+y,0)),O(C),z(n),V(K),_(P)}),o.on("set-cashin",({data:s})=>{$(s)})},[o]);const G=e.jsxs("div",{children:[e.jsx(i,{label:"Cancel",icon:"pi pi-times",onClick:()=>l(!1),className:"p-button-text",size:"small"}),e.jsx(i,{label:"Add",icon:"pi pi-check-circle",onClick:s=>q(s),autoFocus:!0,size:"small"})]}),Y=e.jsx("div",{children:e.jsx(i,{label:"Refresh",icon:"pi pi-refresh",onClick:()=>o.emit("get-summary"),className:"p-button-outlined p-button-secondary",size:"small"})}),q=s=>{s.preventDefault(),p!==""&&u!==""&&m!==""&&(o.emit("add-cashin",{amount:p,desc:u,category:m}),b(""),S(""),v(""),l(!1))},J=s=>(C=>{let n=new Date(C);return[n.getDate()<10?`0${n.getDate()}`:n.getDate(),n.getUTCMonth()+1<10?`0${n.getUTCMonth()+1}`:n.getUTCMonth()+1,n.getUTCFullYear()].join("/")})(s.created_at);return e.jsxs("div",{className:"__cashin",children:[e.jsx("h4",{children:"Cash In"}),e.jsx(i,{icon:h?"pi pi-minus":"pi pi-plus",className:"p",onClick:()=>l(!h),severity:"secondary",size:"small",text:!0}),e.jsxs("div",{className:"cashin-container",children:[e.jsx(ae,{title:"Summary",style:{marginTop:".5rem"},className:"c-card",footer:Y,children:e.jsxs("p",{className:"m-0 summary",children:[e.jsxs("span",{children:["CASH IN:",e.jsx("span",{className:"p-text-secondary p-overlay-badge",style:{cursor:"pointer"},onClick:()=>k(!T),children:((H=D.map(s=>s.cashin).reduce((s,t)=>s+t,0))==null?void 0:H.toLocaleString())||0}),e.jsx(c,{header:"Breakdown",visible:T,style:{width:"50vw"},onHide:()=>k(!1),children:D.map(s=>e.jsxs("span",{"data-pr-tooltip":"see more",className:"card flex",style:{flexWrap:"nowrap",gap:"0.7rem"},children:[e.jsx("span",{children:s.category}),e.jsx("span",{children:s.cashin.toLocaleString()})]},s.cashin))})]}),e.jsxs("span",{children:["CASH OUT:"," ",e.jsx("span",{style:{cursor:"pointer"},onClick:()=>L(!E),children:((M=w.map(s=>s.cashout).reduce((s,t)=>s+t,0))==null?void 0:M.toLocaleString())||0}),e.jsx(c,{header:"Breakdown",visible:E,style:{width:"50vw"},onHide:()=>L(!1),children:w.map(s=>e.jsxs("span",{"data-pr-tooltip":"see more",className:"card flex",style:{flexWrap:"nowrap",gap:"0.7rem"},children:[e.jsx("span",{children:s.category}),e.jsx("span",{children:s.cashout.toLocaleString()})]},s.cashout))})]}),e.jsxs("span",{children:["MARGIN: ",e.jsx("span",{children:(x==null?void 0:x.toLocaleString())||0})]}),e.jsxs("span",{children:["TOTAL DEBT: ",e.jsx("span",{children:(j==null?void 0:j.toLocaleString())||0})]}),e.jsxs("span",{children:["TOTAL REVENUE: ",e.jsx("span",{children:(g==null?void 0:g.toLocaleString())||0})]}),e.jsxs("span",{children:["DEBT / REVENUE: ",e.jsx("span",{children:(f==null?void 0:f.toLocaleString())||0})]}),e.jsxs("span",{children:["OTHERS: ",e.jsx("span",{style:{cursor:"pointer"},onClick:()=>R(!A),children:((B=N.map(s=>s.amount).reduce((s,t)=>s+t,0))==null?void 0:B.toLocaleString())||0}),e.jsx(c,{header:"Breakdown",visible:A,style:{width:"50vw"},onHide:()=>R(!1),children:N.map(s=>e.jsxs("span",{"data-pr-tooltip":"see more",className:"card flex",style:{flexWrap:"nowrap",gap:"0.7rem"},children:[e.jsx("span",{children:s.category}),e.jsx("span",{children:s.amount.toLocaleString()})]},s.amount))})]})]})}),e.jsx("div",{className:"c-p-card",children:e.jsxs(X,{value:W,sortMode:"multiple",width:"100%",children:[e.jsx(d,{field:"description",header:"Description",sortable:!0}),e.jsx(d,{field:"amount",header:"Amount",sortable:!0}),e.jsx(d,{field:"category",header:"Category",sortable:!0}),e.jsx(d,{field:"created_at",header:"Date",sortable:!0,body:J})]})})]}),e.jsx(c,{header:"Cash In",visible:h,onHide:()=>l(!1),style:{width:"30vw"},footer:G,breakpoints:{"960px":"75vw","641px":"100vw"},children:e.jsxs("div",{className:"cashin-card",children:[e.jsxs("span",{className:"p-float-label",children:[e.jsx(Z,{id:"amount",value:p,onValueChange:s=>S(s.value)}),e.jsx("label",{htmlFor:"amount",children:"Amount"})]}),e.jsxs("span",{className:"p-float-label",children:[e.jsx(se,{id:"categ",options:["Revenue","Debt"],value:m,onChange:s=>v(s.value)}),e.jsx("label",{htmlFor:"categ",children:"Category"})]}),e.jsxs("span",{className:"p-float-label",children:[e.jsx(ee,{id:"desc",autoResize:!0,rows:5,cols:10,value:u,onChange:s=>b(s.target.value)}),e.jsx("label",{htmlFor:"desc",children:"Description"})]})]})})]})};export{ce as default};
